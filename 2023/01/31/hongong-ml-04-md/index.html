<!DOCTYPE html>
<html lang=ko>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="naver-site-verification" content="29892ce904ec6054137e0bb84d2f2197d1eb56f4" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- å¼ºåˆ¶é¡µé¢åœ¨å½“å‰çª—å£ä»¥ç‹¬ç«‹é¡µé¢æ˜¾ç¤º,é˜²æ­¢åˆ«äººåœ¨æ¡†æ¶é‡Œè°ƒç”¨é¡µé¢ -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>ML | Decision Tree, Cross validation, Ensemble | jonghwanyoon</title><meta name="robots" content="noindex">
  <meta name="description" content="decision tree, cross validation, ensembleì— ëŒ€í•´ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.   Decision Tree Decision treeëŠ” ë§ˆì¹˜ ìˆœì„œë„ ì²˜ëŸ¼ ì˜ˆ&#x2F;ì•„ë‹ˆì˜¤ ê°™ì€ ì´ì§„ìœ¼ë¡œ ë¶„ë¥˜ëœ ê¸°ì¤€ì„ ì´ì–´ë‚˜ê°€ë©´ì„œ ë¶„ë¥˜ë¥¼ í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ì…ë‹ˆë‹¤. íšŒê·€ë„ ê°€ëŠ¥í•˜ì§€ë§Œ ë¶„ë¥˜ ìœ„ì£¼ë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. Decision Treeì˜ ì¥ì ì€ í•´ì„í•˜ê¸° ì‰½ë‹¤ëŠ”ë°">
<meta property="og:type" content="article">
<meta property="og:title" content="ML | Decision Tree, Cross validation, Ensemble">
<meta property="og:url" content="https://jonghwanyoon.github.io/2023/01/31/hongong-ml-04-md/index.html">
<meta property="og:site_name" content="Jonghwan Yoon">
<meta property="og:description" content="decision tree, cross validation, ensembleì— ëŒ€í•´ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.   Decision Tree Decision treeëŠ” ë§ˆì¹˜ ìˆœì„œë„ ì²˜ëŸ¼ ì˜ˆ&#x2F;ì•„ë‹ˆì˜¤ ê°™ì€ ì´ì§„ìœ¼ë¡œ ë¶„ë¥˜ëœ ê¸°ì¤€ì„ ì´ì–´ë‚˜ê°€ë©´ì„œ ë¶„ë¥˜ë¥¼ í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ì…ë‹ˆë‹¤. íšŒê·€ë„ ê°€ëŠ¥í•˜ì§€ë§Œ ë¶„ë¥˜ ìœ„ì£¼ë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. Decision Treeì˜ ì¥ì ì€ í•´ì„í•˜ê¸° ì‰½ë‹¤ëŠ”ë°">
<meta property="og:locale">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig0.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig1.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig1.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig2.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig3.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig4.png">
<meta property="og:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig5.png">
<meta property="article:published_time" content="2023-01-31T14:04:37.000Z">
<meta property="article:modified_time" content="2023-07-03T12:13:27.614Z">
<meta property="article:author" content="Jonghwan Yoon">
<meta property="article:tag" content="í˜¼ê³µí•™ìŠµë‹¨">
<meta property="article:tag" content="í˜¼ê³µ">
<meta property="article:tag" content="í˜¼ê³µë¨¸ì‹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jonghwanyoon.github.io/images/hongong_ml_04_fig0.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://jonghwanyoon.github.io/2023/01/31/hongong-ml-04-md/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Jonghwan Yoon" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
<meta name="generator" content="Hexo 6.3.0"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://jonghwanyoon.github.io/" target="_blank">
          <img class="img-circle img-rotate" src="/images/blue_whale.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">jonghwanyoon</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Seoul, South Korea</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">Home</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">Archives</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">Categories</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">Tags</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">About</span>
          </a>
        </li>
        
      </ul>
      <!-- 
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/jonghwanyoon" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://www.linkedin.com/in/jonghwan-yoon" target="_blank" title="Linkedin" data-toggle=tooltip data-placement=top><i class="icon icon-linkedin"></i></a></li>
        
    </ul>
 -->
    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      
  <div class="widget">
    <h3 class="widget-title">Categories</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%EC%B1%85/">ì±…</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%EC%B1%85/%ED%98%BC%EC%9E%90-%EA%B3%B5%EB%B6%80%ED%95%98%EB%8A%94-%EC%8B%9C%EB%A6%AC%EC%A6%88/">í˜¼ì ê³µë¶€í•˜ëŠ” ì‹œë¦¬ì¦ˆ</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%ED%98%BC%EA%B3%B5%ED%95%99%EC%8A%B5%EB%8B%A8/">í˜¼ê³µí•™ìŠµë‹¨</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Hexo/" style="font-size: 13.5px;">Hexo</a> <a href="/tags/%EB%A6%AC%EB%B7%B0/" style="font-size: 13px;">ë¦¬ë·°</a> <a href="/tags/%EC%B1%85/" style="font-size: 13.5px;">ì±…</a> <a href="/tags/%EC%BD%94%EB%94%A9-%EC%9D%B8%ED%84%B0%EB%B7%B0/" style="font-size: 13px;">ì½”ë”© ì¸í„°ë·°</a> <a href="/tags/%ED%98%BC%EA%B3%B5/" style="font-size: 14px;">í˜¼ê³µ</a> <a href="/tags/%ED%98%BC%EA%B3%B5C/" style="font-size: 13.5px;">í˜¼ê³µC</a> <a href="/tags/%ED%98%BC%EA%B3%B5S/" style="font-size: 13px;">í˜¼ê³µS</a> <a href="/tags/%ED%98%BC%EA%B3%B5%EB%A8%B8%EC%8B%A0/" style="font-size: 13px;">í˜¼ê³µë¨¸ì‹ </a> <a href="/tags/%ED%98%BC%EA%B3%B5%ED%95%99%EC%8A%B5%EB%8B%A8/" style="font-size: 14px;">í˜¼ê³µí•™ìŠµë‹¨</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%ED%98%BC%EA%B3%B5%ED%95%99%EC%8A%B5%EB%8B%A8/">í˜¼ê³µí•™ìŠµë‹¨</a>
              </p>
              <p class="item-title">
                <a href="/2023/08/20/hongong-c-06/" class="title">í˜¼ì ê³µë¶€í•˜ëŠ” C - í¬ì¸í„°</a>
              </p>
              <p class="item-date">
                <time datetime="2023-08-20T06:48:32.000Z" itemprop="datePublished">2023-08-20</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%EC%B1%85/">ì±…</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/13/book-cracking-the-coding-interview/" class="title">(ì±…) ì½”ë”© ì¸í„°ë·° ì™„ì „ë¶„ì„</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-13T11:50:00.000Z" itemprop="datePublished">2023-07-13</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/Hexo/">Hexo</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/03/you-must-add-nojekyll-in-hexo/" class="title">Hexoì—ì„œ Github pagesì˜ deploy failì‹œ .nojekyllì„ ì¶”ê°€í•˜ì.</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-03T13:29:13.000Z" itemprop="datePublished">2023-07-03</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%EC%B1%85/">ì±…</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%EC%B1%85/%ED%98%BC%EC%9E%90-%EA%B3%B5%EB%B6%80%ED%95%98%EB%8A%94-%EC%8B%9C%EB%A6%AC%EC%A6%88/">í˜¼ì ê³µë¶€í•˜ëŠ” ì‹œë¦¬ì¦ˆ</a>
              </p>
              <p class="item-title">
                <a href="/2023/07/03/hongong-10th-summary/" class="title">(ì±…) í˜¼ì ê³µë¶€í•˜ëŠ” Cì–¸ì–´ ì •ë¦¬</a>
              </p>
              <p class="item-date">
                <time datetime="2023-07-02T15:00:00.000Z" itemprop="datePublished">2023-07-03</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%EC%B1%85/">ì±…</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/%EC%B1%85/%ED%98%BC%EC%9E%90-%EA%B3%B5%EB%B6%80%ED%95%98%EB%8A%94-%EC%8B%9C%EB%A6%AC%EC%A6%88/">í˜¼ì ê³µë¶€í•˜ëŠ” ì‹œë¦¬ì¦ˆ</a>
              </p>
              <p class="item-title">
                <a href="/2023/03/09/hongong-9th-summary/" class="title">(ì±…) í˜¼ì ê³µë¶€í•˜ëŠ” ML/DL, SQL ì •ë¦¬</a>
              </p>
              <p class="item-date">
                <time datetime="2023-03-09T11:54:43.000Z" itemprop="datePublished">2023-03-09</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-hongong-ml-04-md" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      ML | Decision Tree, Cross validation, Ensemble
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2023/01/31/hongong-ml-04-md/" class="article-date">
	  <time datetime="2023-01-31T14:04:37.000Z" itemprop="datePublished">2023-01-31</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%ED%98%BC%EA%B3%B5%ED%95%99%EC%8A%B5%EB%8B%A8/">í˜¼ê³µí•™ìŠµë‹¨</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/%ED%98%BC%EA%B3%B5/" rel="tag">í˜¼ê³µ</a>, <a class="article-tag-link-link" href="/tags/%ED%98%BC%EA%B3%B5%EB%A8%B8%EC%8B%A0/" rel="tag">í˜¼ê³µë¨¸ì‹ </a>, <a class="article-tag-link-link" href="/tags/%ED%98%BC%EA%B3%B5%ED%95%99%EC%8A%B5%EB%8B%A8/" rel="tag">í˜¼ê³µí•™ìŠµë‹¨</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2023/01/31/hongong-ml-04-md/#comments" class="article-comment-link">Comments</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <p><br><br></p>
<p>decision tree, cross validation, ensembleì— ëŒ€í•´ ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.</p>
<p><br><br></p>
<h1 id="decision-tree"><a class="markdownIt-Anchor" href="#decision-tree"></a> Decision Tree</h1>
<p><code>Decision tree</code>ëŠ” ë§ˆì¹˜ ìˆœì„œë„ ì²˜ëŸ¼ ì˜ˆ/ì•„ë‹ˆì˜¤ ê°™ì€ ì´ì§„ìœ¼ë¡œ ë¶„ë¥˜ëœ ê¸°ì¤€ì„ ì´ì–´ë‚˜ê°€ë©´ì„œ ë¶„ë¥˜ë¥¼ í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ ì…ë‹ˆë‹¤. íšŒê·€ë„ ê°€ëŠ¥í•˜ì§€ë§Œ ë¶„ë¥˜ ìœ„ì£¼ë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤. <code>Decision Tree</code>ì˜ ì¥ì ì€ í•´ì„í•˜ê¸° ì‰½ë‹¤ëŠ”ë° ìˆìŠµë‹ˆë‹¤.</p>
<br>
<h2 id="ì™€ì¸-ë¶„ë¥˜í•˜ê¸°"><a class="markdownIt-Anchor" href="#ì™€ì¸-ë¶„ë¥˜í•˜ê¸°"></a> ì™€ì¸ ë¶„ë¥˜í•˜ê¸°</h2>
<p><code>Decision Tree</code>ì˜ ì¥ì ì„ í™•ì¸í•˜ê¸° ìœ„í•´ <code>Logistic Regression</code>ì˜ ë¶„ë¥˜ì™€ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<p>ì•„ë˜ì˜ ë°ì´í„°ë¡œ ì‹¤ìŠµì„ í•´ë³´ê² ìŠµë‹ˆë‹¤. ì™€ì¸ì˜ ì•Œì½œ ë†ë„, ë‹¹ë„, pHì™€ ì™€ì¸ì˜ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.</p>
<p>í´ë˜ìŠ¤ê°€ 0 ì´ë©´ <font color="red">ë ˆë“œ</font>ì™€ì¸, 1ì´ë©´ <font color="gray">í™”ì´íŠ¸</font> ì™€ì¸ì…ë‹ˆë‹¤.</p>
<p>ì™€ì¸ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ <code>Logistic Regression</code>ê³¼ <code>Decision Tree</code>ë¡œ ê°ê° ì§„í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">wine = pd.read_csv(<span class="string">&quot;https://bit.ly/wine_csv_data&quot;</span>)</span><br><span class="line">wine</span><br></pre></td></tr></table></figure>
<center>
<table>
<thead>
<tr>
<th>Index</th>
<th>alcohol</th>
<th>sugar</th>
<th>pH</th>
<th>class</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>9.4</td>
<td>1.9</td>
<td>3.51</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>9.8</td>
<td>2.6</td>
<td>3.2</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>9.8</td>
<td>2.3</td>
<td>3.26</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>9.8</td>
<td>1.9</td>
<td>3.16</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>9.4</td>
<td>1.9</td>
<td>3.51</td>
<td>0</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr>
<td>6492</td>
<td>11.2</td>
<td>1.6</td>
<td>3.27</td>
<td>1</td>
</tr>
<tr>
<td>6493</td>
<td>9.6</td>
<td>8</td>
<td>3.15</td>
<td>1</td>
</tr>
<tr>
<td>6494</td>
<td>9.4</td>
<td>1.2</td>
<td>2.99</td>
<td>1</td>
</tr>
<tr>
<td>6495</td>
<td>12.8</td>
<td>1.1</td>
<td>3.34</td>
<td>1</td>
</tr>
<tr>
<td>6496</td>
<td>11.8</td>
<td>0.8</td>
<td>3.26</td>
<td>1</td>
</tr>
</tbody>
</table>
</center>
<br>
<p><strong>ë¡œì§€ìŠ¤í‹± íšŒê·€ë¡œ ì™€ì¸ ë¶„ë¥˜í•˜ê¸°</strong></p>
<p>trainê³¼ testë¥¼ ë‚˜ëˆ„ê³  Standardizationì„ í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">data = wine[[<span class="string">&quot;alcohol&quot;</span>, <span class="string">&quot;sugar&quot;</span>, <span class="string">&quot;pH&quot;</span>]]</span><br><span class="line">target = wine[<span class="string">&quot;class&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line">train_input, test_input, train_target, test_target = train_test_split(</span><br><span class="line">    data, target, test_size = <span class="number">0.2</span>, random_state = <span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">ss = StandardScaler()</span><br><span class="line">ss.fit(train_input)</span><br><span class="line"></span><br><span class="line">train_scaled = ss.transform(train_input)</span><br><span class="line">test_scaled = ss.transform(test_input)</span><br></pre></td></tr></table></figure>
<br>
<p><strong>LogisticRegression</strong>ìœ¼ë¡œ ë¶„ë¥˜í•˜ì—¬ ì„±ëŠ¥ì„ í™•ì¸í•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(train_scaled, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lr.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(lr.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.7808350971714451</span></span><br><span class="line"><span class="comment"># 0.7776923076923077</span></span><br></pre></td></tr></table></figure>
<br>
<p>trainì…‹ì€ 0.78, testì…‹ì€ 0.77ì˜ ì •í™•ë„ë¥¼ ë³´ì…ë‹ˆë‹¤. ì„±ëŠ¥ì€ ì¢‹ì•„ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì„ í˜• ë°©ì •ì‹ì´ ì–´ë–»ê²Œ í•™ìŠµë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">dict</span>(<span class="built_in">zip</span>(train_input.columns, lr.coef_[<span class="number">0</span>])))</span><br><span class="line"><span class="built_in">print</span>(lr.intercept_)</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;&#x27;alcohol&#x27;: 0.512702742045543, &#x27;sugar&#x27;: 1.6733910972911463, &#x27;pH&#x27;: -0.6876778082262984&#125;</span></span><br><span class="line"><span class="comment"># [1.81777902]</span></span><br></pre></td></tr></table></figure>
<br>
<p>ë°ì´í„°ì— ëŒ€í•œ weightì™€ interceptëŠ” ë‹¤ìŒì²˜ëŸ¼ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ì„í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ ìˆ˜ì¹˜ë¥¼ ë³´ê³ ëŠ” ì•Œì½”ì˜¬ê³¼ ë‹¹ë„ê°€ ë†’ì„ ìˆ˜ë¡ í™”ì´íŠ¸ ì™€ì¸ì¼ ê°€ëŠ¥ì„±ì´ ë†’ê³ , pHê°€ ë†’ì„ ìˆ˜ë¡ ë ˆë“œì™€ì¸ì¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ê³ ë§Œ ìƒê°í•  ìˆœ ìˆì§€ë§Œ ìˆ˜ì¹˜ê°€ ì–´ë–¤ ì˜ë¯¸ê°€ ìˆëŠ”ì§€ëŠ” ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ polynomialë¡œ ë§Œë“ ë‹¤ë©´ ë”ë”ìš± ì•Œê¸° ì–´ë µìŠµë‹ˆë‹¤.</p>
<p><br><br></p>
<p><strong>Decision Tree</strong>ìœ¼ë¡œ ë¶„ë¥˜ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"></span><br><span class="line">dt_clf = DecisionTreeClassifier()</span><br><span class="line">dt_clf.fit(train_scaled, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.996921300750433</span></span><br><span class="line"><span class="comment"># 0.86</span></span><br></pre></td></tr></table></figure>
<p>trainì…‹ì€ 0.99, testì…‹ì€ 0.86ì˜ ì •í™•ë„ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ì ìˆ˜ê°€ trainì´ í›¨ì”¬ ë†’ìœ¼ë¯€ë¡œ overfittingì´ ìˆëŠ”ê±° ê°™ìŠµë‹ˆë‹¤.</p>
<p>decision Treeê°€ ì–´ë–»ê²Œ ë¶„ë¥˜í–ˆëŠ”ì§€ í™•ì¸í•´ë³´ì£ .</p>
<p>ì‹œê°í™”ë¥¼ ìœ„í•´ matplotlibì™€ scikit-learnì˜ <strong>plot_tree</strong>ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> plot_tree</span><br><span class="line"></span><br><span class="line">plt.figure(figsize= (<span class="number">10</span>, <span class="number">7</span>))</span><br><span class="line">plot_tree(dt_clf, rounded=<span class="literal">True</span>, filled = <span class="literal">True</span>, feature_names = [<span class="string">&quot;alcohol&quot;</span>, <span class="string">&quot;suger&quot;</span>, <span class="string">&quot;pH&quot;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/hongong_ml_04_fig0.png" alt="" /></p>
<p>ë³µì¡í•´ ë³´ì´ëŠ” ê·¸ë¦¼ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤. decision treeê°€ ê²°ì •í•˜ëŠ” ë°©ì‹ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. rooted binary tree êµ¬ì¡°ì…ë‹ˆë‹¤. ê·¼ë° ë³´ì´ì§€ ì•Šìœ¼ë‹ˆ <code>max_depth</code>ë¥¼ ì„¤ì •í•´ì„œ ê¹Šì´ 1ê¹Œì§€ë§Œ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize= (<span class="number">10</span>, <span class="number">7</span>))</span><br><span class="line">plot_tree(dt_clf, max_depth = <span class="number">1</span>, rounded=<span class="literal">True</span>, filled = <span class="literal">True</span>, feature_names = [<span class="string">&quot;alcohol&quot;</span>, <span class="string">&quot;suger&quot;</span>, <span class="string">&quot;pH&quot;</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/images/hongong_ml_04_fig1.png" alt="" /></p>
<p>ìƒì ì•ˆì„ ì„¤ëª…í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<ul>
<li>í…ŒìŠ¤íŠ¸ ì¡°ê±´ - sugar</li>
<li>ë¶ˆìˆœë„ (impurity) - gini</li>
<li>ì´ ìƒ˜í”Œ ìˆ˜ - 5197</li>
<li>í´ë˜ìŠ¤ ë³„ ìƒ˜í”Œ ìˆ˜ - [1258, 3939]</li>
</ul>
<p>ë£¨íŠ¸ ë…¸ë“œë¥¼ ì˜ˆë¡œ ë“¤ë©´, ë‹¹ë„ê°€ -0.239 ì´í•˜ê°€ ë§ìœ¼ë©´ ì™¼ìª½ ë…¸ë“œë¡œ ì´ë™í•˜ê³ , ì•„ë‹ˆë¼ë©´ ì˜¤ë¥¸ìª½ ë…¸ë“œë¥¼ ìˆœíšŒí•˜ì—¬ ë‚´ë ¤ê°‘ë‹ˆë‹¤.</p>
<p>ê°ê°ì˜ ë…¸ë“œì—ì„œ í•œ ìª½ í´ë˜ìŠ¤ë¥¼ ì˜ ì˜ˆì¸¡í•  ìˆ˜ë¡ ìƒ‰ê¹”ì„ ì§„í•˜ê²Œ í‘œì‹œí•©ë‹ˆë‹¤.</p>
<h2 id="impurity"><a class="markdownIt-Anchor" href="#impurity"></a> Impurity</h2>
<p>scikit-learnì˜ DecisionTreeClassifierëŠ” impurityë¥¼ ì¸¡ì •í•˜ì—¬ ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.</p>
<p>criterion íŒŒë¼ë¯¸í„°ë¥¼ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>criterion{â€œginiâ€, â€œentropyâ€, â€œlog_lossâ€}, default=â€giniâ€<br />
The function to measure the quality of a split. Supported criteria are â€œginiâ€ for the Gini impurity and â€œlog_lossâ€ and â€œentropyâ€ both for the Shannon information gain, see <a target="_blank" rel="noopener" href="https://scikit-learn.org/stable/modules/tree.html#tree-mathematical-formulation">Mathematical formulation</a>.</p>
</blockquote>
<p>ìˆ˜ì‹ì„ ì²˜ìŒë¶€í„° ì‚´í´ ë³´ë©´ â€¦</p>
<ul>
<li>í•˜ë‚˜ì˜ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ ì‹¤ìˆ˜ë¥¼ <strong>ìŠ¤ì¹¼ë¼</strong>ë¼ê³  ë¶€ë¥´ë©°, $ x $ê°™ì´ ë³€ìˆ˜ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹¤ìˆ˜ ì§‘í•©ì¸ $ R $ ì˜ ì›ì†Œì´ê³  ì´ë¥¼ í‘œì‹œí•˜ë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
\begin{align}
x \in R
\end{align}

<br>
<ul>
<li>ì—¬ëŸ¬ ìˆ«ìê°€ íŠ¹ì • ìˆœì„œëŒ€ë¡œ ëª¨ì—¬ìˆìœ¼ë©´ ë²¡í„°ë¼ê³  í•©ë‹ˆë‹¤.<br>trainì…‹ì„ xë¡œ, testì…‹ì„ yë¡œ í–ˆì„ë•Œ ë²¡í„°ë¥¼ ë‹¤ìŒì²˜ëŸ¼ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
\begin{cases}
\text{train vector}=x_i \in R^n &(i=1, ..., l) \\\
\text{target vector}=y \in R^l
\end{cases}

<ul>
<li>
<p>ì£¼ì–´ì§„ train, target ë²¡í„°ì— ëŒ€í•´ decision treeëŠ” ê°™ì€ target classë¥¼ ê°€ì§„ ë°ì´í„°ë‚˜ ë¹„ìŠ·í•œ target classë¼ë¦¬ sub ê·¸ë£¹ì„ ë§Œë“­ë‹ˆë‹¤.</p>
</li>
<li>
<p>ë…¸ë“œ $ m $ì— ëŒ€í•´ ë¶„ë¥˜ì— ì‚¬ìš©í•  $ n_m $ ê°œì˜ ìƒ˜í”Œì˜ ì§‘í•©ì„ $ Q_m $ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤.</p>
</li>
<li>
<p>feature $ j $ì— ëŒ€í•œ threshold $ t_m $ ìœ¼ë¡œ ë¶„ë¥˜í•  candidate splitì€ $ \theta = (j, t_m) $ ìœ¼ë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
</li>
<li>
<p>ë¶„ë¥˜ë  ìƒ˜í”Œë“¤ì€ $ Q_m^{left}(\theta)$ ì™€ $ Q_m^{right}(\theta) $ ìœ¼ë¡œ subsetì´ ë˜ì–´ ë‚˜ëˆ„ì–´ì§‘ë‹ˆë‹¤.</p>
</li>
</ul>
\begin{cases}

Q_m^{left}(\theta) = {(x, y)|x_j \le t_m}\\\
Q_m^{right}(\theta) = Q_m \setminus Q_m^{left}(\theta)

\end{cases}

<blockquote>
<p>$ A \setminus B $ ëŠ” ì°¨ì§‘í•©<sup>set difference</sup>ìœ¼ë¡œ $ B $ ì˜ ì›ì†Œê°€ í¬í•¨ë˜ì§€ ì•ŠëŠ” $ A $ ì˜ ì›ì†Œë¥¼ ë§í•©ë‹ˆë‹¤.</p>
</blockquote>
<p>ì ê¹ <strong>ì •ë¦¬</strong>ë¥¼ í•˜ë©´, ë…¸ë“œ ì•ˆì—ì„œëŠ” ë¶„ë¥˜í•  ë°ì´í„° ì§‘í•©ì„ Që¡œ ë‚˜íƒ€ë‚´ê³ , featureì˜ ë¶„ë¥˜ ê¸°ì¤€ (threshold)ì— ë”°ë¼ $ Q^{left} $, $ Q^{right} $ ë¡œ ë‚˜ëˆ„ì–´ ì§‘ë‹ˆë‹¤.</p>
<p>ì´ì œ ì—¬ê¸°ì„œ, node $ m $ì˜ candidate splitì— ëŒ€í•œ qualityë¥¼ í•¨ìˆ˜ $ H() $ ë¡œ ê³„ì‚°í•©ë‹ˆë‹¤. í•¨ìˆ˜ì˜ ì¢…ë¥˜ëŠ” í•´ê²°í•˜ê³ ì í•˜ëŠ” ëª¨ë¸ ì¢…ë¥˜ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ë³´í†µì€ gini ì™€ entropyë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p>í´ë˜ìŠ¤ Kê°œê°€ 0, 1, 2, â€¦ K-1 ì´ê³ , ë…¸ë“œ $ m $ ì— ëŒ€í•œ í´ë˜ìŠ¤ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
\begin{align}
p_{mk} = \frac {1} {n_m} \sum_{y\in{Q_m}}I(y=k)
\end{align}

<p><strong>gini</strong></p>
\begin{align}
H(Q_m) = 1 - \sum_{m} (p_{mk})^2
\end{align}

<ul>
<li>ì‰½ê²Œ ë§í•˜ë©´ í´ë˜ìŠ¤ì˜ ë¹„ìœ¨ì„ ì œê³±í•´ì„œ ëª¨ë‘ ë”í•˜ê³  1ì„ ë¹¼ë©´ ë©ë‹ˆë‹¤.</li>
<li>ì´ ê°’ì€ 0~0.5 ì‚¬ì´ë¡œ ë‚˜íƒ€ë‚˜ë©°, 0ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ë¶„ë¥˜ê°€ ì˜ë˜ê³ , 0.5ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ë¶„ë¥˜ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
<li>0ì€ (completely) pure nodeë¼ê³  í•©ë‹ˆë‹¤.</li>
</ul>
<br>
<p><strong>entropy</strong></p>
\begin{align}

H(Q_m) = -\sum_{m}p_{mk}\log_{2}(p_{mk})

\end{align}

<ul>
<li>entropyë„ í´ë˜ìŠ¤ì˜ ë¹„ìœ¨ì„ ì‚¬ìš©í•˜ì§€ë§Œ log2ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.</li>
<li>ì´ ê°’ì€ 0~1 ì‚¬ì´ë¡œ ë‚˜íƒ€ë‚˜ë©°, 0ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ë¶„ë¥˜ê°€ ì˜ë˜ê³ , 1ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ë¶„ë¥˜ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li>
<li>0ì€ (completely) pure nodeë¼ê³  í•©ë‹ˆë‹¤.</li>
</ul>
<p>ë‹¤ì‹œ <strong>ì •ë¦¬</strong>í•˜ë©´, loss function $ H $ ë¥¼ ì´ìš©í•´ í´ë˜ìŠ¤ì˜ ë¹„ìœ¨ì— ë”°ë¼ ì˜ ë¶„ë¥˜í–ˆëŠ”ì§€ì— ëŒ€í•œ ì •ë³´ì¸ impurityë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
<p>ì´ì œ impurityë¥¼ child ë…¸ë“œì— ëŒ€í•´ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
\begin{align}
G(Q_m, \theta) = \frac {n_m^{left}} {n_m} H(Q_m^{left}(\theta)) + \frac {n_m^{right}} {n_m} H(Q_m^{right}(\theta))
\end{align}

<p>parent ë…¸ë“œì™€ì˜ impurity ì°¨ì´ë¥¼ ê³„ì‚°í•˜ì—¬ êµ¬í•˜ê³ , ì´ë¥¼ <strong>information gain</strong> ì´ë¼ê³  í•©ë‹ˆë‹¤. impurityë¥¼ ìµœì†Œí™” í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì•„ì„œ ì„ íƒí•©ë‹ˆë‹¤.</p>
\begin{align}
\theta^* = {\arg}{\min}_\theta G(Q_m, \theta)
\end{align}

<p>ë‹¤ì‹œ ê·¸ë¦¼ìœ¼ë¡œ ëŒì•„ì™€ì„œâ€¦</p>
<p><img src="/images/hongong_ml_04_fig1.png" alt="" /></p>
<p>sklearnì—ì„œëŠ” ê¸°ë³¸ìœ¼ë¡œ ginië¥¼ ì‚¬ìš©í•´ impurityë¥¼ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤.</p>
<p>root nodeë¥¼ ê¸°ì¤€ìœ¼ë¡œ</p>
<ul>
<li>ì „ì²´ ìƒ˜í”Œ ìˆ˜ëŠ” 5197 ì´ê³ , subsetì€ 1258, 3939ê°œë¡œ ë‚˜ëˆ„ì–´ì§‘ë‹ˆë‹¤.</li>
<li>ginië¥¼ ê³„ì‚°í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
\begin{align}
1 - ((\frac {1258} {5197})^2 +(\frac {3939} {5197})^2) = 0.397 
\end{align}

<p><strong>Pruning</strong></p>
<p>decision treeê°€ child nodeë¥¼ ê³„ì† í•™ìŠµí•´ì„œ ë¬´í•œíˆ ë‚´ë ¤ê°€ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ëê¹Œì§€ ê°€ë©´ trainì…‹ì—ëŠ” ë¶„ëª… ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì¼ ê²ƒì´ì§€ë§Œ, overfittingì´ ë  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ê·¸ë¦¼ì´ ë°”ë¡œ ê·¸ ê²°ê³¼ì…ë‹ˆë‹¤.</p>
<p>ì´ëŠ” decision treeì˜ ë‹¨ì ì´ê³ , ì ì ˆí•˜ê²Œ ê°€ì§€ì¹˜ê¸° (pruning)ì„ í•´ì•¼í•©ë‹ˆë‹¤.</p>
<p>DecisionTreeClassfierë¡œ ì²˜ìŒ ëª¨ë¸ì„ ë§Œë“¤ ë•Œ, max_depthë¥¼ ì´ìš©í•´ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 3ìœ¼ë¡œ ì§€ì •í•˜ì—¬ ì‹¤ìŠµí•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dt_clf = DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">dt_clf.fit(train_scaled, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(train_scaled, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(test_scaled, test_target))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.8454877814123533</span></span><br><span class="line"><span class="comment"># 0.8415384615384616</span></span><br></pre></td></tr></table></figure>
<p>trainì…‹ì— ëŒ€í•´ì„œ ì ìˆ˜ëŠ” ë–¨ì–´ì¡Œì§€ë§Œ testì…‹ì€ ê·¸ëŒ€ë¡œì´ê³  ë‘ ë°ì´í„°ì…‹ì˜ ì°¨ì´ê°€ ì—†ì–´ë³´ì…ë‹ˆë‹¤. ì´ì œ treeë¥¼ ê·¸ë ¤ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<p><img src="/images/hongong_ml_04_fig2.png" alt="" /></p>
<p>max_depthê°€ ì„¤ì •í•œëŒ€ë¡œ 3ê¹Œì§€ë§Œ ì¡´ì¬í•©ë‹ˆë‹¤.<br />
í•˜ì§€ë§Œ ì•„ì§ ì„¤ëª…í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶•ë‹ˆ ìˆìŠµë‹ˆë‹¤. root nodeë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë³´ë©´, í‘œì¤€í™”ëœ ë‹¹ë„ì˜ ê°’ì´ -0.239ë³´ë‹¤ ë‚®ê³ , â€¦ ë¼ê³  ë§í•˜ëŠ” ê²ƒì€ í•´ì„ì— ì–´ë ¤ì›€ì´ ìˆìŠµë‹ˆë‹¤. decision treeì˜ ì¥ì  ì¤‘ í•˜ë‚˜ëŠ” í‘œì¤€í™” ì „ì²˜ë¦¬ ì—¬ë¶€ëŠ” decision treeì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤. impurityëŠ” ë‚˜ëˆ„ì–´ì§„ í´ë˜ìŠ¤ì˜ ë¹„ìœ¨ë§Œì„ ê°€ì§€ê³  ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì´ì£ .</p>
<p>í‘œì¤€í™” ì „ì²˜ë¦¬ í•˜ì§€ ì•Šì€ ë°ì´í„°ë¡œ ë‹¤ì‹œ scoreë¥¼ ê³„ì‚°í•˜ê³  plottingì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dt_clf = DecisionTreeClassifier(max_depth=<span class="number">3</span>)</span><br><span class="line">dt_clf.fit(train_input, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(train_input, train_target))</span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(test_input, test_target))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.8454877814123533</span></span><br><span class="line"><span class="comment"># 0.8415384615384616</span></span><br></pre></td></tr></table></figure>
<p>ìŠ¤ì½”ì–´ê°€ ê·¸ëŒ€ë¡œ ì¸ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><img src="/images/hongong_ml_04_fig3.png" alt="" /></p>
<p>impurity ê°’ë“¤ë„ ê·¸ëŒ€ë¡œì…ë‹ˆë‹¤. ê°€ì¥ ì¢‹ì€ê²ƒì€ ë‹¹ë„, ì•Œì½œë†ë„, pHë¥¼ ìˆëŠ” ê·¸ëŒ€ë¡œì˜ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ë‹¹ë„ê°€ 1.625ë³´ë‹¤ í¬ê³  4.324ë³´ë‹¤ ì‘ì€ ì™€ì¸ì—ì„œ ë„ìˆ˜ê°€ 11.025 ì´í•˜ë¼ë©´ ë ˆë“œì™€ì¸, ì•„ë‹ˆë¼ë©´ í™”ì´íŠ¸ ì™€ì¸ìœ¼ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  ê°ê°ì˜ íŠ¹ì„±ì— ëŒ€í•œ ì¤‘ìš”ë„ë¥¼ <code>feature_importances_</code> ë©”ì¨ë“œë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dict</span>(<span class="built_in">zip</span>(train_input.columns, dt_clf.feature_importances_))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;&#x27;alcohol&#x27;: 0.12345625703073809,</span></span><br><span class="line"><span class="comment">#  &#x27;sugar&#x27;: 0.8686293409940407,</span></span><br><span class="line"><span class="comment">#  &#x27;pH&#x27;: 0.007914401975221242&#125;</span></span><br></pre></td></tr></table></figure>
<p>ê²°ê³¼ëŠ”, ë‹¹ë„ê°€ ì™€ì¸ì„ ì˜ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ê¸°ì¤€ì´ ëœë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì¤ë‹ˆë‹¤. ì´ë ‡ê²Œ feature ë³„ë¡œ ì¤‘ìš”ë„ë¥¼ í†µí•´ feature selectionì— í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<br>
<h1 id="êµì°¨ê²€ì¦ê³¼-ê·¸ë¦¬ìŠ¤-ì„œì¹˜"><a class="markdownIt-Anchor" href="#êµì°¨ê²€ì¦ê³¼-ê·¸ë¦¬ìŠ¤-ì„œì¹˜"></a> êµì°¨ê²€ì¦ê³¼ ê·¸ë¦¬ìŠ¤ ì„œì¹˜</h1>
<p>ì§€ê¸ˆê¹Œì§€ ë°ì´í„°ì…‹ì„ í›ˆë ¨ì„¸íŠ¸ê³¼ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ê³  í›ˆë ¨ì„¸íŠ¸ë¥¼ í†µí•´ í•™ìŠµì‹œí‚¨ ëª¨ë¸ë¡œ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¥¼ í‰ê°€í–ˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ°ë° í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì— ëŒ€í•œ ì„±ëŠ¥ì„ ê³„ì† í™•ì¸í•˜ë©´ì„œ ëª¨ë¸ì„ ë§Œë“ ë‹¤ë©´, <strong>ì ì  í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì— ë§ì¶˜ ëª¨ë¸ì´ ë©ë‹ˆë‹¤</strong>.</p>
<blockquote>
<p>ë¨¸ì‹ ëŸ¬ë‹ì´ ì•„ë‹Œ ì§ì ‘ ë§Œë“  ì•Œê³ ë¦¬ì¦˜ì˜ ê²½ìš°, ì´ëŸ° ì‚¬ë¡€ê°€ ë§ìŠµë‹ˆë‹¤â€¦ğŸ˜®ğŸ˜®</p>
</blockquote>
<p>ê·¸ëŸ¬ë¯€ë¡œ, ë§Œë“¤ì–´ì§„ ëª¨ë¸ì— ëŒ€í•´ì„œ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì˜ ì„±ëŠ¥ìœ¼ë¡œ <strong>ì•ìœ¼ë¡œì˜ ì„±ëŠ¥ë„ ì´ëŸ´ ê²ƒì´ë‹¤ë¼ëŠ” ì¼ë°˜í™”</strong>ë¥¼ ì‹ ë¢°í•˜ë ¤ë©´, í…ŒìŠ¤íŠ¸ì„¸íŠ¸ëŠ” ê°€ëŠ¥í•œí•œ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ë§ˆì§€ë§‰ ê²€ì¦ì—ë§Œ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
<p>í•˜ì§€ë§Œ, í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ overfitting, underfittingì„ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
<p>ì´ ê²½ìš° ê²€ì¦ ì„¸íŠ¸<sup>validation set</sup>ê°€ í•´ê²°í•´ ì¤„ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><br><br></p>
<center>
<img width=600px src=https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/ML_dataset_training_validation_test_sets.png/800px-ML_dataset_training_validation_test_sets.png?20201206114522>
<br>
<p><font color=gray><a target="_blank" rel="noopener" href="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/ML_dataset_training_validation_test_sets.png/800px-ML_dataset_training_validation_test_sets.png?20201206114522">Train, Validation, Test set</a><br></font></center></p>
<p><br><br></p>
<p>ì•„ì£¼ ê°„ë‹¨í•˜ê²Œ í›ˆë ¨ì„¸íŠ¸ì—ì„œ ë˜ë‹¤ì‹œ ì¼ë¶€ë¥¼ ë‚˜ëˆˆ ê²ƒì…ë‹ˆë‹¤. ë³´í†µ 20~30%ë¥¼ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì™€ ê²€ì¦ì„¸íŠ¸ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.</p>
<p>ìœ„ì—ì„œ ì‚¬ìš©í•œ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<br>
<p><strong>ê²€ì¦ì„¸íŠ¸ ë§Œë“¤ê¸°</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sub_input, val_input, sub_target, val_target = train_test_split(</span><br><span class="line">    train_input, train_target, test_size = <span class="number">0.2</span>, random_state=<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sub_input.shape, val_input.shape)</span><br><span class="line"><span class="comment"># (4157, 3) (1040, 3)</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>train_test_splitì— train_inputì„ ë„£ì—ˆìŠµë‹ˆë‹¤</em></p>
</blockquote>
<br>
<p><strong>í›ˆë ¨ì„¸íŠ¸ì™€ ê²€ì¦ì„¸íŠ¸ë¡œ scoreí™•ì¸</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dt_clf = DecisionTreeClassifier()</span><br><span class="line">dt_clf.fit(sub_input, sub_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(sub_input, sub_target))</span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(val_input, val_target))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0.9971133028626413</span></span><br><span class="line"><span class="comment"># 0.8586538461538461</span></span><br></pre></td></tr></table></figure>
<p>ì ìˆ˜ë¥¼ ë³´ë‹ˆ í›ˆë ¨ì„¸íŠ¸ì— overfittingë˜ì–´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</p>
<br>
<h3 id="êµì°¨-ê²€ì¦"><a class="markdownIt-Anchor" href="#êµì°¨-ê²€ì¦"></a> êµì°¨ ê²€ì¦</h3>
<p>ê²€ì¦ì„¸íŠ¸ê°€ ì™œ ì‚¬ìš©í•˜ëŠ”ì§€ëŠ” ì´í•´ê°€ ë©ë‹ˆë‹¤ë§Œ, ì´ëŸ¬ë©´ í›ˆë ¨ì„¸íŠ¸ì˜ í¬ê¸°ê°€ ì¤„ì–´ë“¤ì–´ì„œ í•™ìŠµì´ ì œëŒ€ë¡œ ë˜ì§€ ì•Šì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ê³  ê²€ì¦ì„¸íŠ¸ì˜ í¬ê¸°ë¥¼ ì¤„ì´ë©´ ì œëŒ€ë¡œ ê²€ì¦ì´ ë˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ê²€ì¦ì„¸íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ êµì°¨ê²€ì¦<sup>Cross validation</sup>ì„ ì´ìš©í•©ë‹ˆë‹¤.</p>
<p><br><br></p>
<center>
<img width=800px src=/images/hongong_ml_04_mission.png>
<br>
<p><font color=gray>êµì°¨ ê²€ì¦ì˜ ì˜ˆì‹œ<br></font></center></p>
<p><br><br></p>
<p>êµì°¨ê²€ì¦ì´ë€, ê²€ì¦ì„¸íŠ¸ë¥¼ ë‚˜ëˆ„ì–´ í‰ê°€í•˜ëŠ” ê³¼ì •ì„ ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•©ë‹ˆë‹¤. ë³´í†µ Kë²ˆ ë°˜ë³µí•˜ëŠ” êµì°¨ê²€ì¦ì„ <strong>K-fold cross validation</strong>ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
<p>ìœ„ ê·¸ë¦¼ì—ì„œ ê²€ì •ìƒ‰ ë„¤ëª¨ì¹¸ì„ ê²€ì¦ì„¸íŠ¸ì— ëŒ€í•´ì„œ Kë²ˆ í‰ê°€ë¥¼ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë³´í†µ <strong>í‰ê°€ëœ ì ìˆ˜ì˜ í‰ê· </strong>ì„ ëŒ€í‘œê°’ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p>scikit-learnì—ì„œëŠ” ì´ë¥¼ ìë™ìœ¼ë¡œ í•´ì£¼ëŠ” cross_validateë¼ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_validate</span><br><span class="line"></span><br><span class="line">dt_clf = DecisionTreeClassifier()</span><br><span class="line">scores = cross_validate(dt_clf, train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(scores)</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;&#x27;fit_time&#x27;: array([0.00964594, 0.00899792, 0.00821495, 0.00859427, 0.00850391]),</span></span><br><span class="line"><span class="comment">#  &#x27;score_time&#x27;: array([0.002074  , 0.0016861 , 0.00194216, 0.00178385, 0.00165391]),</span></span><br><span class="line"><span class="comment">#  &#x27;test_score&#x27;: array([0.87115385, 0.85576923, 0.87776708, 0.85466795, 0.8373436 ])&#125;</span></span><br></pre></td></tr></table></figure>
<p>fit_time, score_time, test_scoreë¥¼ ê°€ì§„ dictionaryë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. cross_validateëŠ” 5-foldê°€ defaultì´ë¯€ë¡œ ê°’ë„ 5ê°œì”© ìˆìŠµë‹ˆë‹¤. <code>cv</code> ë§¤ê°œë³€ìˆ˜ë¡œ Fold ìˆ˜ë¥¼ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>fit_time: í›ˆë ¨í•˜ëŠ” ì‹œê°„</li>
<li>score_time: ê²€ì¦í•˜ëŠ” ì‹œê°„</li>
<li>test_score: ê²€ì¦ ì ìˆ˜</li>
</ul>
<p>ê²€ì¦ ì ìˆ˜ì˜ í‰ê· ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.8545302435774044</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>ì—¬ê¸°ì„œëŠ” train_inputê³¼ train_targetì— ëŒ€í•´ cross_validationì„ í–ˆìœ¼ë¯€ë¡œ, test_scoreì˜ ì ìˆ˜ëŠ” ì´ë¦„ì€ testì§€ë§Œ ê²€ì¦ì„¸íŠ¸ë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤.</p>
</blockquote>
<p><strong>Splitter</strong></p>
<p>ì§€ê¸ˆê¹Œì§€ëŠ” train_test_splitìœ¼ë¡œ ì „ì²´ ë°ì´í„°ë¥¼ ì„ê³  í›ˆë ¨ì„¸íŠ¸ë¥¼ ë½‘ì•„ì„œ ì„ì„ í•„ìš”ëŠ” ì—†ì—ˆì§€ë§Œ, êµì°¨ ê²€ì¦ì„ í•  ë•Œ, í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì„ìœ¼ë ¤ë©´ splitterë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<ul>
<li>Regression: KFold</li>
<li>Classification: StratifiedKFold</li>
</ul>
<p>ì§€ê¸ˆì€ ë¶„ë¥˜ì´ë¯€ë¡œ StratifiedKFoldë¥¼ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> StratifiedKFold</span><br><span class="line">scores = cross_validate(dt_clf, train_input, train_target, cv = StratifiedKFold())</span><br><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.8601106833493745</span></span><br></pre></td></tr></table></figure>
<br>
<p><code>cross_validate</code> í•¨ìˆ˜ì˜ cv ë§¤ê°œë³€ìˆ˜ë¡œ <code>StratifiedKFold()</code>ë¥¼ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<p>ê¸°ë³¸ì€ 5 foldì´ê³ , foldìˆ˜ë¥¼ ë°”ê¾¸ë ¤ë©´ StratifiedKFoldì˜ <code>n_splits</code>ë¥¼ ë°”ê¾¸ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<br>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">splitter = StratifiedKFold(n_splits = <span class="number">10</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(dt_clf, train_input, train_target, cv = splitter)</span><br><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.8604972580406105</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<p>ì¢‹ìŠµë‹ˆë‹¤. êµì°¨ê²€ì¦ì„ ì§„í–‰í•˜ë©´ì„œë„ í•œì¸µ ê°„ê²°í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p>ê·¸ëŸ°ë° ë¬¸ì œê°€ í•˜ë‚˜ ìˆìŠµë‹ˆë‹¤. max_depthê°™ì€ ì‚¬ìš©ìê°€ ì§€ì •í•˜ëŠ” ì˜µì…˜ì€ ì–´ë–»ê²Œ ìµœì ê°’ì„ ì°¾ì„ê¹Œìš”?</p>
<p><br><br></p>
<h3 id="í•˜ì´í¼íŒŒë¼ë¯¸í„°-íŠœë‹"><a class="markdownIt-Anchor" href="#í•˜ì´í¼íŒŒë¼ë¯¸í„°-íŠœë‹"></a> í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹</h3>
<p>decision treeì—ì„œ max_depth ê°™ì€ ìœ ì €ê°€ ì§ì ‘ ì§€ì •í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ <strong>í•˜ì´í¼íŒŒë¼ë¯¸í„°</strong> ë¼ê³  í•©ë‹ˆë‹¤.</p>
<p>ì¤‘ìš”í•œ ì ì€ ëª¨ë¸ë§ˆë‹¤ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë©°, í•˜ë‚˜ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìµœì í™” í–ˆë‹¤ê³  ê³ ì •ê°’ì´ ë ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ decision treeì˜ max_depthì˜ ìµœì ê°’ì„ ì°¾ì€ ë‹¤ìŒì— ë‹¤ì‹œ  min_samples_splitì˜ ìµœì ê°’ì„ ì°¾ëŠ” ê²ƒì€ ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤. ë‘ íŒŒë¼ë¯¸í„°ì— ëŒ€í•´ì„œ ë™ì‹œì— ìµœì ê°’ì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.</p>
<p>ì´ë¥¼ <code>GridSearchCV</code> í´ë˜ìŠ¤ê°€ í¸ë¦¬í•˜ê²Œ í•´ê²°í•´ì¤ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">params = <span class="built_in">dict</span>(min_impurity_decrease = np.arange(<span class="number">0.0001</span>, <span class="number">0.001</span>, <span class="number">0.0001</span>),</span><br><span class="line">              max_depth = <span class="built_in">range</span>(<span class="number">5</span>, <span class="number">20</span>, <span class="number">1</span>),</span><br><span class="line">              min_samples_split = <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">100</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">gs = GridSearchCV(DecisionTreeClassifier(random_state = <span class="number">42</span>),</span><br><span class="line">                  param_grid = params,</span><br><span class="line">                  n_jobs = <span class="number">4</span>)</span><br><span class="line">gs.fit(train_input, train_target)</span><br></pre></td></tr></table></figure>
<ul>
<li>í•˜ì´í¼íŒŒë¼ë¯¸í„°ëŠ” dictionary í˜•íƒœë¡œ GridSearchCVì—ëŠ” param_gridì— ë„£ì–´ì¤ë‹ˆë‹¤. (positional inputìœ¼ë¡œ 2ë²ˆì§¸ì— key ì—†ì´ ë„£ì–´ì¤˜ë„ ë©ë‹ˆë‹¤.)</li>
<li>n_jobsëŠ” ì‚¬ìš©í•  ë³‘ë ¬ ì»´í“¨íŒ…ì— ì‚¬ìš©í•  CPUìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. defaultëŠ” 1ì´ê³ , -1ì€ ê°€ìš©í•œ ìì›ì„ ëª¨ë‘ ì‚¬ìš©í•©ë‹ˆë‹¤.<br>paramsì— 3ê°€ì§€ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ë™ì‹œì— êµì°¨ê²€ì¦ì„ í•˜ë¯€ë¡œ, í•™ìŠµì€ $ 10x15x10 = 1350 $ ë²ˆ í•˜ê²Œ ë˜ê³ , 5-foldê°€ ê¸°ë³¸ì´ë¯€ë¡œ 6750ê°œì˜ ëª¨ë¸ì„ ìƒì„±í•©ë‹ˆë‹¤. ë”°ë¼ì„œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ íŠœë‹í•  ë•Œì—ëŠ” ì‚¬ìš©í•  CPUìˆ˜ë¥¼ ì ì ˆíˆ ì§€ì •í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.</li>
</ul>
<br>
<p>ê°€ì¥ ì˜ì°¾ì€ íŒŒë¼ë¯¸í„° ì¡°í•©ì€ best_params_ ìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(gs.best_params_)</span><br><span class="line"><span class="comment"># &#123;&#x27;max_depth&#x27;: 14, &#x27;min_impurity_decrease&#x27;: 0.0004, &#x27;min_samples_split&#x27;: 12&#125;</span></span><br></pre></td></tr></table></figure>
<br>
<p>ê°€ì¥ ì¢‹ì€ êµì°¨ê²€ì¦ ì ìˆ˜ëŠ” <code>cv_results_[&quot;mean_test_score&quot;]</code>ì˜ ìµœëŒ€ê°’ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">max</span>(gs.cv_results_[<span class="string">&quot;mean_test_score&quot;</span>]))</span><br><span class="line"><span class="comment"># 0.8683865773302731</span></span><br></pre></td></tr></table></figure>
<br>
<p>ê°€ì¥ ì¢‹ì€ ì ìˆ˜ì˜ ëª¨ë¸ì„ <code>best_estimator_</code>ìœ¼ë¡œ ì €ì¥ë˜ì–´ ìˆê³  ë°”ë¡œ decision tree ëª¨ë¸ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dt_clf = gs.best_estimator_</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(train_input, train_target))</span><br><span class="line"><span class="comment"># 0.892053107562055</span></span><br><span class="line"><span class="built_in">print</span>(dt_clf.score(test_input, test_target))</span><br><span class="line"><span class="comment"># 0.8615384615384616</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h3 id="ëœë¤-ì„œì¹˜"><a class="markdownIt-Anchor" href="#ëœë¤-ì„œì¹˜"></a> ëœë¤ ì„œì¹˜</h3>
<p>í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì¹˜ë¡œ ì…ë ¥í•´ì•¼ í•  ë•Œ, ì ì ˆí•œ ê°’ì˜ ë²”ìœ„ë¥¼ ì•Œê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´, min_impurity_decrease ì˜ ê¸°ë³¸ê°’ì€ 0.0001 ì…ë‹ˆë‹¤. ëŒ€ì¶© 0.001 ì •ë„ë¥¼ ìµœëŒ€ë¡œ í•´ë³¸ë‹¤ê³  í•´ë„, 0.0001 ë‹¨ìœ„ë¡œ í• ì§€ 0.0002 ë‹¨ìœ„ë¡œ í• ì§€ëŠ” ì• ë§¤í•©ë‹ˆë‹¤.</p>
<p>ê²Œë‹¤ê°€ ë„ˆë¬´ ë§ì€ ê°’ì„ ê·¸ë¦¬ë“œì„œì¹˜ì— ì‚¬ìš©í•˜ë©´ ìˆ˜í–‰ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì´ëŸ´ ë•Œ, <strong>ëœë¤ ì„œì¹˜</strong>ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<p>íŒŒë¼ë¯¸í„° ë”•ì…”ë„ˆë¦¬ì—ì„œ ê° ë§¤ê°œë³€ìˆ˜ì˜ valueì— ëœë¤ ìƒ˜í”Œë§ì„ í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ë„£ì–´ì£¼ë©´ ë˜ê³  <strong>GridSearchCV</strong>ê°€ ì•„ë‹Œ <strong>RandomizedSearchCV</strong>ë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. scipyì˜ uniformê³¼ randintë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> uniform, randint</span><br><span class="line"></span><br><span class="line">rgen = randint(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(rgen.rvs(<span class="number">10</span>))</span><br><span class="line"><span class="comment"># [6 3 6 2 5 9 7 8 8 7]</span></span><br><span class="line"></span><br><span class="line">ugen = uniform(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(ugen.rvs(<span class="number">10</span>))</span><br><span class="line"><span class="comment"># [0.74803462 0.10100137 0.88553271 0.1432955  0.1551121  0.16308304 0.44705319 0.25044722 0.66360482 0.10661267]</span></span><br></pre></td></tr></table></figure>
<p>ë„ˆë¬´ ì‘ì€ ê°’ì´ì§€ë§Œ ëœë¤í•˜ê²Œ ì˜ ë½‘ì•„ ì¤ë‹ˆë‹¤.</p>
<br>
<br>
<p><strong>ëœë¤í•˜ê²Œ ë½‘ì€ 10000ê°œ ì •ìˆ˜ì˜ ë¶„í¬</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int_array = randint(<span class="number">0</span>, <span class="number">10</span>).rvs(<span class="number">10000</span>)</span><br><span class="line">pd.DataFrame(int_array).plot.hist()</span><br></pre></td></tr></table></figure>
<p><img src="/images/hongong_ml_04_fig4.png" alt="" /></p>
<br>
<p><strong>ëœë¤í•˜ê²Œ ë½‘ì€ 10000ê°œ ì‹¤ìˆ˜ì˜ ë¶„í¬</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">float_array = uniform(<span class="number">0</span>, <span class="number">1</span>).rvs(<span class="number">10000</span>)</span><br><span class="line">pd.DataFrame(float_array).plot.hist()</span><br></pre></td></tr></table></figure>
<p><img src="/images/hongong_ml_04_fig5.png" alt="" /></p>
<br>
<p><strong>RandomizedSearchCV ì‚¬ìš©í•´ë³´ê¸°</strong></p>
<p>ì•„ë˜ paramsì˜ ê° valueëŠ” uniformê³¼ randintë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ëœë¤ìœ¼ë¡œ ë½‘ì•„ì„œ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì—, RandomizedSearchCVì˜ n_iterë¥¼ ì„¤ì •í•˜ì—¬ ëª‡ ë²ˆ ìˆ˜í–‰í• ì§€ ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤. ê¸°ë³¸ì€ 10ë²ˆì´ê³ , ì—¬ê¸°ì„œëŠ” 100ìœ¼ë¡œ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<blockquote>
<p>GridSearchCVì™€ ë‹¬ë¦¬ param_gridëŠ” positional inputìœ¼ë¡œ ë„£ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> RandomizedSearchCV</span><br><span class="line"></span><br><span class="line">params = <span class="built_in">dict</span>(min_impurity_decrease = uniform(<span class="number">0.0001</span>, <span class="number">0.001</span>),</span><br><span class="line">              max_depth = randint(<span class="number">5</span>, <span class="number">20</span>),</span><br><span class="line">              min_samples_split = randint(<span class="number">2</span>, <span class="number">25</span>),</span><br><span class="line">              min_samples_leaf = randint(<span class="number">1</span>, <span class="number">25</span>))</span><br><span class="line"></span><br><span class="line">gs = RandomizedSearchCV(DecisionTreeClassifier(random_state = <span class="number">42</span>),</span><br><span class="line">                        params,</span><br><span class="line">                        n_iter = <span class="number">100</span>,</span><br><span class="line">                        n_jobs = <span class="number">4</span>)</span><br><span class="line">gs.fit(train_input, train_target)</span><br></pre></td></tr></table></figure>
<br>
<p>ìµœì  íŒŒë¼ë¯¸í„° ê°’ì˜ ì¡°í•©ì„ ì¶œë ¥í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(gs.best_params_)</span><br><span class="line"><span class="comment"># &#123;&#x27;max_depth&#x27;: 39, &#x27;min_impurity_decrease&#x27;: 0.00034102546602601173, &#x27;min_samples_leaf&#x27;: 7, &#x27;min_samples_split&#x27;: 13&#125;</span></span><br></pre></td></tr></table></figure>
<br>
<p>ê°€ì¥ ë†’ì€ êµì°¨ê²€ì¦ ì ìˆ˜ë„ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.<span class="built_in">max</span>(gs.cv_results_[<span class="string">&quot;mean_test_score&quot;</span>]))</span><br><span class="line"><span class="comment"># 0.8695428296438884</span></span><br></pre></td></tr></table></figure>
<br>
<p>ìµœì  ëª¨ë¸ì„ ê°€ì ¸ì˜¤ê³  í…ŒìŠ¤íŠ¸ì…‹ì˜ ì„±ëŠ¥ì„ í™•ì¸í•´ë´…ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dt = gs.best_estimator_</span><br><span class="line"><span class="built_in">print</span>(dt.score(test_input, test_target))</span><br><span class="line"><span class="comment"># 0.86</span></span><br></pre></td></tr></table></figure>
<br>
<p>ì´ì œ, ì—¬ëŸ¬ íŒŒë¼ë¯¸í„°ë¡œ ëª¨ë¸ì„ ë§Œë“¤ë•Œ, ì¶©ë¶„íˆ ë‹¤ì–‘í•˜ê²Œ ì‹œë„í•´ ë³¼ìˆ˜ ìˆë‹¤ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ê²Œë‹¤ê°€ í•œì •ëœ ìì›ì—ì„œ ëœë¤í•˜ê²Œ íŒŒë¼ë¯¸í„°ê°’ì„ ì¡°ì‚¬í•´ íš¨ìœ¨ì ìœ¼ë¡œ ìµœì  íŒŒë¼ë¯¸í„°ë„ ì°¾ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<p><br><br></p>
<h1 id="íŠ¸ë¦¬ì˜-ì•™ìƒë¸”"><a class="markdownIt-Anchor" href="#íŠ¸ë¦¬ì˜-ì•™ìƒë¸”"></a> íŠ¸ë¦¬ì˜ ì•™ìƒë¸”</h1>
<p>ì´ë²ˆì—ëŠ” decision treeë¥¼ í™•ì¥í•´ì„œ ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ ì•„ì£¼ì•„ì£¼ ë§ì´ ì‚¬ìš©ë˜ëŠ” ì•™ìƒë¸” ëª¨ë¸ì„ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<br>
<h2 id="ëœë¤-í¬ë ˆìŠ¤íŠ¸"><a class="markdownIt-Anchor" href="#ëœë¤-í¬ë ˆìŠ¤íŠ¸"></a> ëœë¤ í¬ë ˆìŠ¤íŠ¸</h2>
<p>ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” decision treeë¥¼ ëœë¤í•˜ê²Œ ì—¬ëŸ¬ê°œë¥¼ ë§Œë“¤ì˜ <strong>ìˆ²</strong>ì„ ë§Œë“­ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê° Treeì˜ ì˜ˆì¸¡ì„ ì‚¬ìš©í•´ ìµœì¢… ì˜ˆì¸¡ì„ ë§Œë“œëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.</p>
<p><strong>ë¶€íŠ¸ìŠ¤íŠ¸ë©<sup>Bootstrap</sup></strong> ìƒ˜í”Œì´ë€ ë°ì´í„° ì§‘í•©ì—ì„œ ë³µì›ì¶”ì¶œí•œ ìƒ˜í”Œì…ë‹ˆë‹¤. ì´ë¥¼ ì—¬ëŸ¬ë²ˆ ë³µì› ì¶”ì¶œ í•˜ëŠ” ê³¼ì •ì„ ë¦¬ìƒ˜í”Œë§<sup>Resampling</sup>ì´ë¼ê³  í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 1000ê°œì˜ ìƒ˜í”Œì—ì„œ 1ê°œë¥¼ ë½‘ê³  ë‹¤ì‹œ ëŒë ¤ë†“ëŠ” ê²ƒì´ ë³µì› ì¶”ì¶œì¸ë°, ì´ë¥¼ 100ë²ˆ ë°˜ë³µí•´ ì–»ì€ ìƒ˜í”Œì…ë‹ˆë‹¤. ë”°ë¼ì„œ <strong>ì¤‘ë³µëœ ìƒ˜í”Œë„ í—ˆìš©</strong>ë©ë‹ˆë‹¤. ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œì€ ë‹¨ì§€ ì´ë ‡ê²Œ ë½‘ì€ ê²°ê³¼ê°€ ì›ë˜ í‘œë³¸ê³¼ ë¹„ìŠ·í•˜ë‹¤ê³  ìƒê°í•˜ê³  ì§„í–‰í•©ë‹ˆë‹¤.</p>
<p>ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œì„ ì´ìš©í•´ ê°ê°ì˜ Treeë¥¼ í•™ìŠµì‹œí‚µë‹ˆë‹¤.</p>
<p>scikit-learnì—ì„œëŠ” ë¶„ë¥˜ì™€ íšŒê·€ì— ëŒ€í•´ ì•„ë˜ ëª¨ë¸ì´ ìˆìŠµë‹ˆë‹¤.</p>
<br>
<ul>
<li>
<p>RandomForestClassifer</p>
<ul>
<li>ì¼ë¶€ë¥¼ ë¬´ì‘ìœ„ë¡œ ê³¨ë¼ì„œ ì´ ì¤‘ì—ì„œ ìµœì ì„ ì°¾ì•„ì„œ ë…¸ë“œë¥¼ ë¶„í• í•©ë‹ˆë‹¤. ì „ì²´ feature ê°œìˆ˜ì˜ ì œê³±ê·¼ ë§Œí¼ì˜ íŠ¹ì„±ì„ ì„ íƒí•©ë‹ˆë‹¤. ì¦‰, 4ê°œì˜ featureê°€ ìˆì„ ë–„ 2ê°œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
<li>ê° Treeì˜ í´ë˜ìŠ¤ë³„ í™•ë¥ ì˜ í‰ê· ì„ ëŒ€í‘œê°’ìœ¼ë¡œ ê°€ì¥ ë†’ì€ í™•ë¥ ì„ ê°€ì§„ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡ê°’ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
</li>
<li>
<p>RandomForestRegressor</p>
<ul>
<li>ì „ì²´ featureë¥¼ ëª¨ë‘ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
<li>ê° íŠ¸ë¦¬ì˜ ì˜ˆì¸¡ê°’ì˜ í‰ê· ì„ ëŒ€í‘œê°’ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
</li>
</ul>
<br>
<p>ëœë¤í¬ë ˆìŠ¤íŠ¸ëŠ” decision treeì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ëª¨ë‘ ì œê³µí•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  <strong>í›ˆë ¨ë°ì´í„°ì˜ íŠ¹ì„± ì¤‘ìš”ë„ë„ ì œê³µ</strong>í•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rf.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">dict</span>(<span class="built_in">zip</span>(train_input.columns, rf.feature_importances_))</span><br><span class="line"><span class="comment"># &#123;&#x27;alcohol&#x27;: 0.23167441093509658,</span></span><br><span class="line"><span class="comment">#  &#x27;sugar&#x27;: 0.5003984054070982,</span></span><br><span class="line"><span class="comment">#  &#x27;pH&#x27;: 0.26792718365780516&#125;</span></span><br></pre></td></tr></table></figure>
<br>
<p>decision tree ì‹¤ìŠµì—ì„œëŠ” ë‹¹ë„ê°€ 0.86 ì˜ ì¤‘ìš”ë„ì˜€ëŠ”ë° ì—¬ê¸°ì„œëŠ” 0.5ë¡œ ë‚®ì•„ì¡ŒìŠµë‹ˆë‹¤. ì´ëŠ” ëœë¤í¬ë ˆìŠ¤íŠ¸ê°€ íŠ¹ì„±ì˜ ì¼ë¶€ë¥¼ ëœë¤í•˜ê²Œ ì„ íƒí•˜ì—¬ í›ˆë ¤í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í•˜ë‚˜ì˜ íŠ¹ì„±ì— ì§‘ì¤‘í•˜ì§€ ì•Šë„ë¡ í•˜ê³  ë‹¤ë¥¸ íŠ¹ì„±ë„ í•™ìŠµí•  ê¸°íšŒë¥¼ ì–»ìŠµë‹ˆë‹¤. ê²°ë¡ ì ìœ¼ë¡œëŠ” overfittingì„ ì¤„ì´ê³  ì¼ë°˜í™” ì„±ëŠ¥ì„ ë†’ì´ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ì¶”ê°€ë¡œ, ë¶€íŠ¸ìŠ¤íŠ¸ë©ì€ ë³µì›ì¶”ì¶œì„ í•˜ë¯€ë¡œ ë¶€íŠ¸ìŠ¤íŠ¸ë©ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” ìƒ˜í”Œì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì´ë¥¼ OOB<sup>Out of bag</sup> ìƒ˜í”Œì´ë¼ í•©ë‹ˆë‹¤. ë¶€íŠ¸ìŠ¤íŠ¸ë©ì— í¬í•¨ë˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ í•™ìŠµì— í¬í•¨ë˜ì§€ ì•Šì•˜ê² êµ°ìš”.<br />
ëœë¤ í¬ë ˆìŠ¤íŠ¸ëŠ” OOB ìƒ˜í”Œì„ ê²€ì¦ì„¸íŠ¸ì²˜ëŸ¼ ì‚¬ìš©í•´ í‰ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rf = RandomForestClassifier(oob_score = <span class="literal">True</span>, n_jobs = <span class="number">4</span>, random_state = <span class="number">42</span>)</span><br><span class="line">rf.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(rf.oob_score_)</span><br><span class="line"><span class="comment"># 0.8934000384837406</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="ì—‘ìŠ¤íŠ¸ë¼-íŠ¸ë¦¬supextra-treesup"><a class="markdownIt-Anchor" href="#ì—‘ìŠ¤íŠ¸ë¼-íŠ¸ë¦¬supextra-treesup"></a> ì—‘ìŠ¤íŠ¸ë¼ íŠ¸ë¦¬<sup>Extra Tree</sup></h2>
<p>ëœë¤ í¬ë ˆìŠ¤íŠ¸ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ, ë¶€íŠ¸ìŠ¤íŠ¸ë© ìƒ˜í”Œì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  íŠ¸ë¦¬ë¥¼ ë§Œë“¤ ë•Œ ëª¨ë“  ìƒ˜í”Œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë˜í•œ ë…¸ë“œë¥¼ ë¶„í• í•  ë•Œ, ê°€ì¥ ì¢‹ì€ ë¶„í• ì´ ì•„ë‹Œ ë¬´ì‘ìœ„ë¡œ ë¶„í• í•©ë‹ˆë‹¤.</p>
<p>ë¬´ì‘ìœ„ì´ë¯€ë¡œ ì„±ëŠ¥ì€ ë‚®ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë‚˜, overfittingì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> ExtraTreesClassifier</span><br><span class="line"></span><br><span class="line">et = ExtraTreesClassifier(n_jobs=<span class="number">4</span>, random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(et, train_input, train_target,</span><br><span class="line">                        return_train_score=<span class="literal">True</span>, n_jobs=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;train_score&quot;</span>].mean(), scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.9974503966084433 0.8887848893166506</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<p>feature importanceë„ ë™ì¼í•˜ê²Œ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">et.fit(train_input, train_target)</span><br><span class="line"><span class="built_in">print</span>(et.feature_importances_)</span><br><span class="line"><span class="comment"># [0.20183568 0.52242907 0.27573525]</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<h2 id="ê·¸ë ˆì´ë””ì–¸íŠ¸-ë¶€ìŠ¤íŒ…supgradient-boostingsup"><a class="markdownIt-Anchor" href="#ê·¸ë ˆì´ë””ì–¸íŠ¸-ë¶€ìŠ¤íŒ…supgradient-boostingsup"></a> ê·¸ë ˆì´ë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…<sup>Gradient boosting</sup></h2>
<p>depthê°€ ë‚®ì€ treeë¡œ binary treeì˜ ì˜¤ì°¨ë¥¼ ë³´ì™„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
<p>GradientBoostingClassifierëŠ” defaultë¡œ depthê°€ 3ì¸ treeë¥¼ 100ê°œ ì‚¬ìš©í•©ë‹ˆë‹¤. depthê°€ 3ì´ë¯€ë¡œ overfittingì— ê°•í•˜ê³  ë†’ì€ ì¼ë°˜í™” ì„±ëŠ¥ì„ ë³´ì…ë‹ˆë‹¤.</p>
<p>ì´ì „ì— ì •ë¦¬í•œ <a href="https://jonghwanyoon.github.io/2023/01/24/hongong_ml_03/"><strong>Gradient descent</strong></a>ë¥¼ ì‚¬ìš©í•˜ì—¬ treeë¥¼ ì•™ìƒë¸”ì— ì¶”ê°€í•©ë‹ˆë‹¤. ì†ì‹¤ í•¨ìˆ˜ëŠ” ì•„ë˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<ul>
<li>classification: logistic loss function</li>
<li>Regression: Mean squared error</li>
</ul>
<p><br><br></p>
<p><strong>ì‹¤ìŠµ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</span><br><span class="line"></span><br><span class="line">gb = GradientBoostingClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(gb, train_input, train_target,</span><br><span class="line">                        return_train_score=<span class="literal">True</span>, n_jobs=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;train_score&quot;</span>].mean(), scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.8881086892152563 0.8720430147331015</span></span><br></pre></td></tr></table></figure>
<p><br><br></p>
<p>í›ˆë ¨ì„¸íŠ¸ê³¼ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì˜ ì ìˆ˜ë¥¼ ë³´ë‹ˆ overfittingì´ ê±°ì˜ ì¼ì–´ë‚˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë¦¬ê³  <strong>subsample</strong>ë¼ëŠ” íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ”ë° í›ˆë ¨ì„¸íŠ¸ì˜ ë¹„ìœ¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ 1.0ì¸ë°, ì´ë¥¼ ì¤„ì´ë©´ ê·¸ë§Œí¼ì˜ ë¹„ìœ¨ë§Œ ì‚¬ìš©í•˜ê²Œ ë˜ê³ , ê·¸ëŸ¬ë©´ <strong>stochastic gradient descent</strong>ë‚˜ <strong>mini batch gradient descent</strong>ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.</p>
<p>ì„±ëŠ¥ì€ ëœë¤í¬ë ˆìŠ¤íŠ¸ë³´ë‹¤ ë†’ì„ ìˆ˜ ìˆì§€ë§Œ, íŠ¸ë¦¬ë¥¼ ìˆœì„œëŒ€ë¡œ ì¶”ê°€í•˜ê¸° ë•Œë¬¸ì— í›ˆë ¨ì´ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤. í•˜ë‚˜ì”© í›ˆë ¨í•˜ê¸°ì— GradientBoostingClassifierì—ëŠ” ë³‘ë ¬ ì»´í“¨íŒ… íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
<p>ê·¸ë˜ì„œ ì†ë„ì™€ ì„±ëŠ¥ì„ ë”ìš± ê°œì„ í•œ íˆìŠ¤í† ê·¸ë¨ ê¸°ë°˜ ê·¸ë ˆë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…ì´ ìˆìŠµë‹ˆë‹¤.</p>
<p><br><br></p>
<h2 id="íˆìŠ¤í† ê·¸ë¨-ê¸°ë°˜-ê·¸ë ˆë””ì–¸íŠ¸-ë¶€ìŠ¤íŒ…suphistogram-based-gradient-boostingsup"><a class="markdownIt-Anchor" href="#íˆìŠ¤í† ê·¸ë¨-ê¸°ë°˜-ê·¸ë ˆë””ì–¸íŠ¸-ë¶€ìŠ¤íŒ…suphistogram-based-gradient-boostingsup"></a> íˆìŠ¤í† ê·¸ë¨ ê¸°ë°˜ ê·¸ë ˆë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…<sup>Histogram-based gradient boosting</sup></h2>
<ul>
<li>ì •í˜• ë°ì´í„° (tabular ë°ì´í„° ê°™ì€)ì— ëŒ€í•œ ML ì•Œê³ ë¦¬ì¦˜ ì¤‘ ì¸ê¸°ê°€ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤.</li>
<li>ì´ ëª¨ë¸ì€ input featureë¥¼ 256ê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ, Nodeë¥¼ ë¶„í•  ì‹œ ìµœì  ë¶„í• ì„ <strong>ë¹ ë¥´ê²Œ</strong> ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
<li>HistGradientBoostingClassifierëŠ” ì¼ë°˜ì ìœ¼ë¡  defaultì—ì„œ ì„±ëŠ¥ì´ ì¢‹ìŠµë‹ˆë‹¤.</li>
<li>treeì˜ ê°œìˆ˜ë¥¼ ì§€ì •í•˜ëŠ”ë°ì—ëŠ” n_estimators ëŒ€ì‹  max_iterë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì„±ëŠ¥ì„ ë†’ì´ë ¤ë©´ max_iterë¥¼ ì‚¬ìš©í•©ì‹œë‹¤.</li>
</ul>
<br>
<p><strong>ì‹¤ìŠµ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sklearnì—ì„œëŠ” ì•„ì§ í…ŒìŠ¤íŠ¸ ì¤‘ì…ë‹ˆë‹¤. enable_hist_gradient_boostingê°€ í•„ìš”í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">from</span> sklearn.experimental <span class="keyword">import</span> enable_hist_gradient_boosting</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> HistGradientBoostingClassifier</span><br><span class="line"></span><br><span class="line">hgb = HistGradientBoostingClassifier(random_state=<span class="number">42</span>)</span><br><span class="line">scores = cross_validate(hgb, train_input, train_target,</span><br><span class="line">                        return_train_score=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(scores[<span class="string">&quot;train_score&quot;</span>].mean(), scores[<span class="string">&quot;test_score&quot;</span>].mean())</span><br><span class="line"><span class="comment"># 0.9321723946453317 0.8801241948619236</span></span><br></pre></td></tr></table></figure>
<br>
<p>feature importanceë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” permutation_importanceë¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤. íŠ¹ì„±ì„ ëœë¤í•˜ê²Œ ì„ê³  ëª¨ë¸ì˜ ì„±ëŠ¥ì´ ë³€í™”í•˜ëŠ”ì§€ ê´€ì°°í›„ ì–´ëŠ íŠ¹ì„±ì´ ì¤‘ìš”í•œì§€ ê³„ì‚°í•©ë‹ˆë‹¤. ì´ ëª¨ë¸ì´ ì•„ë‹Œ ë‹¤ë¥¸ ëª¨ë¸ì—ë„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<br>
<p><strong>permutation_importance</strong></p>
<p>permutation_importanceì˜ returnê°’ì€ íŠ¹ì„± ì¤‘ìš”ë„, ì¤‘ìš”ë„ì˜ í‰ê· , í‘œì¤€ í¸ì°¨ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì¤‘ìš”ë„ì˜ ë¹„ìœ¨ì€ ëœë¤í¬ë ˆìŠ¤íŠ¸ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.inspection <span class="keyword">import</span> permutation_importance</span><br><span class="line"></span><br><span class="line">hgb.fit(train_input, train_target)</span><br><span class="line">result = permutation_importance(hgb, train_input, train_target,</span><br><span class="line">                                n_repeats = <span class="number">10</span>, random_state=<span class="number">42</span>, n_jobs = <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(result.importances_mean)</span><br><span class="line"><span class="comment"># [0.08876275 0.23438522 0.08027708]</span></span><br></pre></td></tr></table></figure>
<p><strong>í…ŒìŠ¤íŠ¸ ì…‹ í™•ì¸</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hgb.score(test_input, test_target)</span><br><span class="line"><span class="comment"># 0.8723076923076923</span></span><br></pre></td></tr></table></figure>
<br>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ scikit-learnì´ ì•„ë‹Œ ë‹¤ë¥¸ <strong>íˆìŠ¤í† ê·¸ë¨ ê¸°ë°˜ ê·¸ë ˆë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ…</strong>ì„ êµ¬í˜„í•œ <strong>ë¼ì´ë¸ŒëŸ¬ë¦¬</strong>ëŠ” xgboostì™€ lightgbì´ ìˆìŠµë‹ˆë‹¤. scikit-learnì˜ cross validation í•¨ìˆ˜ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>xgboostëŠ” ë‹¤ì–‘í•œ ë¶€ìŠ¤íŒ… ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•´ì¤ë‹ˆë‹¤.</p>
<p>lightGBMì€ ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì—ì„œ ë§Œë“¤ì—ˆëŠ”ë°, ë¹ ë¥´ê³  ìµœì‹ ê¸°ìˆ ì„ ë§ì´ ì ìš©í•´ ì¸ê¸°ê°€ ì¢‹ìŠµë‹ˆë‹¤.</p>
<p><br><br></p>
<p>ì´ë²ˆì—ëŠ” decision tree, cross validation, ensemble ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ì‹œê°„ì´ ë ë•Œë§ˆë‹¤ ì›ë¦¬ì™€ ìˆ˜ì‹ì„ ì¶”ê°€ë¡œ ê³µë¶€í•˜ëŠ”ê²Œ ë„ì›€ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
<p>ë‹¤ìŒì—ëŠ” clustering ë° PCA ê°™ì€ ë¹„ì§€ë„ í•™ìŠµì— ëŒ€í•´ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.</p>
<p>ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ‘‹</p>
<p><br><br></p>
<h3 id="ps"><a class="markdownIt-Anchor" href="#ps"></a> <strong>p.s.</strong></h3>
<br>
<center>
<img width=600px src=/images/hongong_gift2.jpeg >
<p>2ì£¼ì°¨ ì»¤í”¼ì™€ 3ì£¼ì°¨ í¬ë¡œí”Œ ì„ ë¬¼ ê°ì‚¬í•©ë‹ˆë‹¤!</p>
</center>
<p><br><br><br><br></p>
<!-- flag of hidden posts -->
      
    </div>
    <div class="article-footer">
      <!-- <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://jonghwanyoon.github.io/2023/01/31/hongong-ml-04-md/" title="ML | Decision Tree, Cross validation, Ensemble" target="_blank" rel="external">https://jonghwanyoon.github.io/2023/01/31/hongong-ml-04-md/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CNåè®®</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
    </li>
  </ul>
</blockquote> -->
<!-- 

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://jonghwanyoon.github.io/" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/blue_whale.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://jonghwanyoon.github.io/" target="_blank"><span class="text-dark">jonghwanyoon</span><small class="ml-1x"></small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>
 -->

    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  
  
  <div class="bar-right">
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/jonghwanyoon" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://www.linkedin.com/in/jonghwan-yoon" target="_blank" title="Linkedin" data-toggle=tooltip data-placement=top><i class="icon icon-linkedin"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        &copy; 2023 Jonghwan Yoon
        
        <div class="publishby">
        	<!-- Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>. -->
            Theme by <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   
    
    <script defer>
    var disqus_config = function () {
        
            this.page.url = 'https://jonghwanyoon.github.io/2023/01/31/hongong-ml-04-md/';
        
        this.page.identifier = 'hongong-ml-04-md';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'wg-yoon' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>






    <script defer type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-140384355-2', 'auto');
ga('send', 'pageview');

</script>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>